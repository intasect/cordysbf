<!--
	The default build file for Ant.
	!!DO NOT EDIT THIS FILE!!
	This file can be overwritten when an upgrade of the framework is done.
	
	Customizations should be done in the build-project.xml or the build-user.xml.
-->
<project default="dummy" xmlns:sa="http://subclipse.tigris.org/svnant">
	<!-- Cobertura coverage checker -->
	<taskdef classpathref="classpath" name="cobertura-instrument" classname="net.sourceforge.cobertura.ant.InstrumentTask"/>
	<taskdef classpathref="classpath" name="cobertura-merge" classname="net.sourceforge.cobertura.ant.MergeTask"/>
	<taskdef classpathref="classpath" name="cobertura-report" classname="net.sourceforge.cobertura.ant.ReportTask"/>
	<taskdef classpathref="classpath" name="cobertura-check" classname="net.sourceforge.cobertura.ant.CheckTask"/>

	<!-- Dummy target -->		
	<target name="dummy" />
	
	<!-- Import all the Build framework targets. -->
  	<typedef resource="com/cordys/coe/ant/bf/bfantlib.xml" classpathref="classpath"/>
  	
  	<!-- Import the svnAnt targets -->
  	<typedef resource="svnantlib.xml" classpathref="classpath"/>
	<typedef resource="org/tigris/subversion/svnant/svnantlib.xml" classpathref="classpath" uri="http://subclipse.tigris.org/svnant"/>
	
	<!-- XMLTask -->
	<taskdef name="xmltask" classname="com.oopsconsultancy.xmltask.ant.XmlTask" classpathref="classpath"/>

	<!--
		Macro to check the value of a certain property for true and if it's true
		add a defined.<propertyname> to the project.
	-->
	<macrodef name="defflag">
		<attribute name="property" />
		<attribute name="dest-property" default="defined.@{property}" />        
		<sequential>
			<condition property="@{dest-property}">
				<istrue value="${@{property}}"/>
			</condition>
		</sequential>
	</macrodef>
	
	<!--
		Macro to check the if the given property is set and if not fail with an error message.
	-->
    <macrodef name="check-property">
        <attribute name="property" />
    	<attribute name="message-no-prop" default="Property @{property} needs to be set."/>
        <sequential>
    		<fail message="@{message-no-prop}">
    			<condition>
    				<not>
	    				<isset property="@{property}" />
    				</not>
    			</condition>
    		</fail>     
        </sequential>
    </macrodef>	
	
	<!--
		Macro to check the if the given property is set and points to an exising file or directory.
		Otherwise fail with an error message.
	-->
    <macrodef name="check-file-property">
        <attribute name="property" />
    	<attribute name="message-no-prop" default="Property @{property} needs to be set."/>
		<attribute name="message-no-file" default="Property @{property} needs to point to an existing file or directory."/>
        <sequential>
    		<fail message="@{message-no-prop}">
    			<condition>
    				<not>
	    				<isset property="@{property}" />
    				</not>
    			</condition>
    		</fail>     
    		<fail message="@{message-no-file}">
    			<condition>
    				<not>
	    				<available file="${@{property}}" />
    				</not>
    			</condition>
    		</fail>      			
        </sequential>
    </macrodef>
	
	<!--
		Macro to convert the given path to an absolute path.
	-->	
	<macrodef name="abspath">
		<attribute name="path" />
		<attribute name="property" />
		<sequential>
			<pathconvert property="@{property}" dirsep="/">
				<path path="@{path}" />
			</pathconvert>
		</sequential>
	</macrodef>

	<!--
		Macro for the content type check.
	-->
	<macrodef name="check-cordys-operation">
		<attribute name="contenttype" />
		<attribute name="operation" />
		<sequential>
			<fail message="This content type operation is not allowed.">
				<condition>
					<not>
						<checkcontentoperation 
							contenttype="@{contenttype}"
							operation="@{operation}"
							prompt="${content.prompt.@{operation}}"
						/>
					</not>
				</condition>
			</fail>	
		</sequential>
	</macrodef>
</project>